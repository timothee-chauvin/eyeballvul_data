{
  "id": "CVE-2026-27128",
  "published": "2026-02-24T02:42:53.706000",
  "modified": "2026-02-26T01:24:29.133828",
  "details": "Craft is a content management system (CMS). In versions 4.5.0-RC1 through 4.16.18 and 5.0.0-RC1 through 5.8.22, a Time-of-Check-Time-of-Use (TOCTOU) race condition exists in Craft CMS\u2019s token validation service for tokens that explicitly set a limited usage. The `getTokenRoute()` method reads a token\u2019s usage count, checks if it\u2019s within limits, then updates the database in separate non-atomic operations. By sending concurrent requests, an attacker can use a single-use impersonation token multiple times before the database update completes. To make this work, an attacker needs to obtain a valid user account impersonation URL with a non-expired token via some other means and exploit a race condition while bypassing any rate-limiting rules in place. For this to be a privilege escalation, the impersonation URL must include a token for a user account with more permissions than the current user. Versions 4.16.19 and 5.8.23 patch the issue.",
  "summary": "Craft CMS's race condition in Token Service potentially allows for token usage greater than the token limit",
  "severity": [
    {
      "type": "CVSS_V4",
      "score": "CVSS:4.0/AV:N/AC:H/AT:P/PR:H/UI:N/VC:H/VI:N/VA:N/SC:H/SI:N/SA:N"
    }
  ],
  "repo_url": "https://github.com/craftcms/cms",
  "cwes": [],
  "commits": [
    "964fec5696fd72e4009ca43c646cda90a60adc6c",
    "fbef5f2421b1d2517feb2b3a6eb33e3f6924172a"
  ]
}
