{
  "id": "CVE-2025-59154",
  "published": "2025-09-15T20:03:34",
  "modified": "2025-10-22T18:46:47.735698",
  "details": "Openfire is an XMPP server licensed under the Open Source Apache License. Openfire\u2019s SASL EXTERNAL mechanism for client TLS authentication contains a vulnerability in how it extracts user identities from X.509 certificates. Instead of parsing the structured ASN.1 data, the code calls X509Certificate.getSubjectDN().getName() and applies a regex to look for CN=. This method produces a provider-dependent string that does not escape special characters. In SunJSSE (sun.security.x509.X500Name), for example, commas and equals signs inside attribute values are not escaped. As a result, a malicious certificate can embed CN= inside another attribute value (e.g. OU=\"CN=admin,\"). The regex will incorrectly interpret this as a legitimate Common Name and extract admin. If SASL EXTERNAL is enabled and configured to map CNs to user accounts, this allows the attacker to impersonate another user. The fix is included in Openfire 5.0.2 and 5.1.0.",
  "summary": "Openfire allows potential identity spoofing via unsafe CN parsing",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:N"
    }
  ],
  "repo_url": "https://github.com/igniterealtime/openfire",
  "cwes": [],
  "commits": [
    "c2d6f7a3627a5b051ca4c61d76200fe3413bb4ea"
  ]
}
