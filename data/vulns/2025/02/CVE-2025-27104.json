{
  "id": "CVE-2025-27104",
  "published": "2025-02-21T21:32:24.621000",
  "modified": "2025-11-20T12:34:42.597244",
  "details": "vyper is a Pythonic Smart Contract Language for the EVM. Multiple evaluation of a single expression is possible in the iterator target of a for loop. While the iterator expression cannot produce multiple writes, it can consume side effects produced in the loop body (e.g. read a storage variable updated in the loop body) and thus lead to unexpected program behavior. Specifically, reads in iterators which contain an ifexp (e.g. `for s: uint256 in ([read(), read()] if True else [])`) may interleave reads with writes in the loop body. Vyper for loops allow two kinds of iterator targets, namely the `range()` builtin and an iterable type, like SArray and DArray. During codegen, iterable lists are required to not produce any side-effects (in the following code, `range_scope` forces `iter_list` to be parsed in a constant context, which is checked against `is_constant`). However, this does not prevent the iterator from consuming side effects provided by the body of the loop. For SArrays on the other hand, `iter_list` is instantiated in the body of a `repeat` ir, so it can be evaluated several times. This issue is being addressed and is expected to be available in version 0.4.1. Users are advised to upgrade as soon as the patched release is available. There are no known workarounds for this vulnerability.",
  "summary": "double eval in For List Iter in Vyper",
  "severity": [
    {
      "type": "CVSS_V4",
      "score": "CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:N/VC:L/VI:L/VA:N/SC:N/SI:N/SA:N"
    }
  ],
  "repo_url": "https://github.com/vyperlang/vyper",
  "cwes": [],
  "commits": [
    "6020b8bbf66b062d299d87bc7e4eddc4c9d1c157",
    "9136169468f317a53b4e7448389aa315f90b95ba",
    "cac3d7d99f64c995a3dd7e9584fdabd617819ba2"
  ]
}
