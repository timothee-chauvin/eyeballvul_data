{
  "id": "CVE-2021-30159",
  "published": "2021-04-09T07:15:16",
  "modified": "2024-05-30T03:05:07.323463",
  "details": "An issue was discovered in MediaWiki before 1.31.12 and 1.32.x through 1.35.x before 1.35.2. Users can bypass intended restrictions on deleting pages in certain \"fast double move\" situations. MovePage::isValidMoveTarget() uses FOR UPDATE, but it's only called if Title::getArticleID() returns non-zero with no special flags. Next, MovePage::moveToInternal() will delete the page if getArticleID(READ_LATEST) is non-zero. Therefore, if the page is missing in the replica DB, isValidMove() will return true, and then moveToInternal() will unconditionally delete the page if it can be found in the master.",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N"
    }
  ],
  "repo_url": "https://github.com/wikimedia/mediawiki",
  "cwes": [],
  "commits": [
    "5cfc9accca2cc2fb94060c309d562913b7bed57c",
    "c7733ad8e5b7f0cc181f2537fb50aeed6cb9f75b"
  ]
}
